<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record model="ir.ui.view" id="auth_passkey_users_form">
        <field name="name">auth.passkey.users.form</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="base.view_users_form"/>
        <field name="arch" type="xml">
            <notebook>
                <group string="Settings">
                    <field name="password_login_disabled"/>
                    <button colspan="2" invisible="password_login_disabled" type="object" name="action_delete_password_other" string="Delete Password"/>
                </group>
                <page string="Account Security" name="page_account_security_passkeys">
                    <group string="Passkeys">
                        <field colspan="4" name="auth_passkey_key_ids" string="">
                            <kanban create="false">
                                <field name="name"/>
                                    <templates>
                                        <t t-name="kanban-menu">
                                            <a role="menuitem" type="object" name="action_rename_passkey" class="dropdown-item">Rename</a>
                                            <a role="menuitem" type="delete" class="dropdown-item">Delete</a>
                                        </t>
                                        <t t-name="kanban-box">
                                            <div class="oe_kanban_card">
                                                <div class="oe_kanban_details">
                                                    <div class="o_kanban_record_top">
                                                        <div class="o_kanban_record_headings">
                                                            <strong class="o_kanban_record_title">
                                                                <field name="name"/>
                                                            </strong>
                                                        </div>
                                                    </div>
                                                    <ul>
                                                        <li>Created: <field name="create_date"/></li>
                                                        <li>Last used: <field name="write_date"/></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </t>
                                    </templates>
                            </kanban>
                        </field>
                    </group>
                </page>
            </notebook>
        </field>
    </record>

    <record model="ir.ui.view" id="auth_passkey_users_preferences">
        <field name="name">auth.passkey.users.preferences</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="base.view_users_form_simple_modif"/>
        <field name="arch" type="xml">
            <page string="Account Security" name="page_account_security">
                <group string="Passkeys">
                    <div colspan="2">
                        <div class="text-muted mb-3" colspan="2">
                            Passkeys are used to bypass the username and password and log you directly into your account.
                        </div>
                        <field name="password_login_disabled" invisible="1"/>
                        <field name="allow_password_delete" invisible="1"/>
                        <div class="mb-2 gap-1" style="display: flex;" colspan="4">
                            <button colspan="2" type="object" name="action_create_passkey" class="btn-secondary" string="Add Passkey"/>
                            <button colspan="2" type="object" name="action_delete_password_self" class="btn-secondary" string="Delete Password" invisible="password_login_disabled or auth_passkey_key_ids.length == 0 or not allow_password_delete"/>
                        </div>
                        <field colspan="4" name="auth_passkey_key_ids">
                            <kanban create="false">
                                <field name="name"/>
                                <templates>
                                    <t t-name="kanban-menu">
                                        <a role="menuitem" type="object" name="action_rename_passkey" class="dropdown-item">Rename</a>
                                        <a role="menuitem" type="delete" class="dropdown-item">Delete</a>
                                    </t>
                                    <t t-name="kanban-box">
                                        <div class="oe_kanban_card">
                                            <div class="oe_kanban_details">
                                                <div class="o_kanban_record_top">
                                                    <div class="o_kanban_record_headings">
                                                        <strong class="o_kanban_record_title">
                                                            <field name="name"/>
                                                        </strong>
                                                    </div>
                                                </div>
                                                <ul>
                                                    <li>Created: <field name="create_date"/></li>
                                                    <li>Last used: <field name="write_date"/></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </t>
                                </templates>
                            </kanban>
                        </field>
                    </div>
                </group>
            </page>
        </field>
    </record>

    <record id="res_users_delete_password_self" model="ir.ui.view">
        <field name="name">Revoke All Devices</field>
        <field name="model">res.users</field>
        <field name="arch" type="xml">
            <form string="Delete Password">
                <div>
                    You are about to delete your password. This means you will only be able to login with your Passkey. Are you sure you wish to continue?
                </div>
                <footer>
                    <button string="Delete Password" name="delete_password" type="object" class="btn-primary" data-hotkey="q"/>
                    <button string="Cancel" class="btn-secondary" special="cancel" data-hotkey="x" />
                </footer>
            </form>
        </field>
    </record>

    <record id="res_users_delete_password_other" model="ir.ui.view">
        <field name="name">Revoke All Devices</field>
        <field name="model">res.users</field>
        <field name="arch" type="xml">
            <form string="Delete Password">
                <div>
                    You are about to delete this user's password. This means they will only be able to login with their Passkey. Are you sure you wish to continue?
                </div>
                <footer>
                    <button string="Delete Password" name="delete_password" type="object" class="btn-primary" data-hotkey="q"/>
                    <button string="Cancel" class="btn-secondary" special="cancel" data-hotkey="x" />
                </footer>
            </form>
        </field>
    </record>
</odoo>

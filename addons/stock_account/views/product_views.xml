<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="product_template_tree_view" model="ir.ui.view">
            <field name="name">product.template.tree.inherit.stock.account</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_tree_view"/>
            <field name="arch" type="xml">
                <field name="standard_price" position="attributes">
                    <attribute name="readonly">1</attribute>
                </field>
            </field>
        </record>

        <record id="view_stock_product_tree_account_group_inherit" model="ir.ui.view">
            <field name="name">product.stock.tree.account.group.inherit</field>
            <field name="model">product.product</field>
            <field name="inherit_id" ref="stock.view_stock_product_tree"/>
            <field name="arch" type="xml">
                <field name="qty_available" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </field>
                <field name="virtual_available" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </field>
            </field>
        </record>

        <record id="view_stock_product_template_tree_account_group_inherit" model="ir.ui.view">
            <field name="name">product.template.stock.tree.account.group.inherit</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="stock.view_stock_product_template_tree"/>
            <field name="arch" type="xml">
                <field name="show_on_hand_qty_status_button" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </field>
                <field name="qty_available" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </field>
                <field name="virtual_available" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </field>
                <field name="responsible_id" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </field>
            </field>
        </record>

        <record id="product_template_kanban_stock_view_account_group_inherit" model="ir.ui.view">
            <field name="name">product.template.stock.kanban.account.group.inherit</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="stock.product_template_kanban_stock_view"/>
            <field name="arch" type="xml">
                <field name="show_on_hand_qty_status_button" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </field>
                <xpath expr="//t[@name='show_qty_available']" position="attributes">
                    <attribute name="groups" separator="," add="account.group_account_invoice,account.group_account_readonly"/>
                </xpath>
            </field>
        </record>

        <record id="view_category_property_form_stock" model="ir.ui.view">
            <field name="name">product.category.stock.property.form.inherit.stock</field>
            <field name="model">product.category</field>
            <field name="inherit_id" ref="stock.product_category_form_view_inherit"/>
            <field name="arch" type="xml">
                <group name="logistics" position="after">
                    <group string="Inventory Valuation">
                        <field name="property_cost_method"/>
                        <field name="property_valuation" groups="account.group_account_readonly,stock.group_stock_manager"/>
                    </group>
                </group>
            </field>
        </record>

        <record id="view_category_property_form" model="ir.ui.view">
            <field name="name">product.category.stock.property.form.inherit</field>
            <field name="model">product.category</field>
            <field name="inherit_id" ref="account.view_category_property_form"/>
            <field name="arch" type="xml">
                <group name="account_property" position="inside">
                    <group name="account_stock_property" string="Account Stock Properties" groups="account.group_account_readonly" attrs="{'invisible':[('property_valuation', '=', 'manual_periodic')]}">
                        <field name="property_valuation" invisible="1"/>
                        <field name="property_stock_valuation_account_id" options="{'no_create': True}" attrs="{'required':[('property_valuation', '=', 'real_time')]}"/>
                        <field name="property_stock_journal" attrs="{'required':[('property_valuation', '=', 'real_time')]}" />
                        <field name="property_stock_account_input_categ_id" options="{'no_create': True}" attrs="{'required':[ ('property_valuation', '=', 'real_time')]}" />
                        <field name="property_stock_account_output_categ_id" options="{'no_create': True}" attrs="{'required':[ ('property_valuation', '=', 'real_time')]}" />
                        <div colspan="2" class="alert alert-info mt16" role="status">
                            <b>Set other input/output accounts on specific </b><button name="%(stock.action_prod_inv_location_form)d" role="button" type="action" class="btn-link" style="padding: 0;vertical-align: baseline;" string="locations"/>.
                        </div>
                    </group>
                </group>
            </field>
        </record>

        <!-- Stock Report View -->
        <record model="ir.ui.view" id="product_product_stock_tree_inherit_stock_account">
            <field name="name">product.product.stock.tree.inherit.stock.account</field>
            <field name="model">product.product</field>
            <field name="inherit_id" ref="stock.product_product_stock_tree"/>
            <field name="arch" type="xml">
                <field name="qty_available" position="before">
                    <field name="company_currency_id" invisible="1"/>
                    <field name="cost_method" invisible="1"/>
                    <field name="avg_cost" string="Unit Cost" optional="show" widget='monetary' options="{'currency_field': 'company_currency_id'}"/>
                    <field name="total_value" string="Total Value" optional="show" widget='monetary' options="{'currency_field': 'company_currency_id'}" sum="Total Value"/>
                    <button name="%(stock_valuation_layer_action)d" title="Valuation Report" type="action" class="btn-link"
                        icon="fa-bar-chart" context="{'search_default_product_id': id, 'default_product_id': id}"  attrs="{'invisible': [('cost_method', '!=', 'average')]}"/>
                    <button name="%(stock_valuation_layer_report_action)d" title="Valuation Report" type="action" class="btn-link"
                        icon="fa-bar-chart" context="{'search_default_product_id': id, 'default_product_id': id}"  attrs="{'invisible': [('cost_method', '!=', 'fifo')]}"/>
                </field>
            </field>
        </record>
   </data>
</odoo>

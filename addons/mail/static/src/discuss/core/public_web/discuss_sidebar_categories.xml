<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="mail.DiscussSidebarCategories">
        <hr class="my-2 w-100 opacity-0 flex-shrink-0"/>
        <input t-if="hasQuickSearch" class="form-control mx-4 mb-2 rounded-3 w-auto lh-1" placeholder="Quick searchâ€¦" t-model="state.quickSearchVal"/>
        <t t-foreach="store.discuss.allCategories" t-as="cat" t-key="cat_index">
            <t t-if="cat.isVisible" t-call="mail.DiscussSidebarCategory">
                <t t-set="category" t-value="cat"/>
            </t>
        </t>
    </t>

    <t t-name="mail.DiscussSidebarCategory">
        <div class="o-mail-DiscussSidebarCategory d-flex align-items-center my-1" t-att-class="category.extraClass" name="header">
            <button class="btn btn-link text-reset flex-grow-1 d-flex align-items-baseline me-1 px-2 py-1 text-start" t-att-class="{ 'opacity-75-hover opacity-50': store.theme === 'dark', 'opacity-100-hover opacity-75': store.theme !== 'dark' }" t-on-click="() => this.toggleCategory(category)" name="toggler">
                <span t-if="store.channels.status === 'fetching'" class="o-visible-short-delay"><i class="o-mail-DiscussSidebarCategory-icon o-smaller me-1 fa fa-fw fa-circle-o-notch fa-spin opacity-50"/></span>
                <i t-else="" class="o-mail-DiscussSidebarCategory-icon smaller" t-att-class="category.open ? 'oi oi-chevron-down' : 'oi oi-chevron-right'"/>
                <span class="btn-sm p-0 text-uppercase text-break fw-bolder smaller"><t t-esc="category.name"/></span>
            </button>
            <div t-if="!category.open and store.getDiscussSidebarCategoryCounter(category.id) > 0" class="o-mail-DiscussSidebar-badge badge rounded-pill me-3 o-discuss-badge fw-bold">
                <t t-esc="store.getDiscussSidebarCategoryCounter(category.id)"/>
            </div>
        </div>
        <t t-if="category.open">
            <DiscussSidebarChannel t-foreach="filteredThreads(category)" t-as="thread" t-key="thread.localId" thread="thread"/>
        </t>
        <DiscussSidebarChannel t-elif="store.discuss.thread?.in(category.threads)" thread="store.discuss.thread"/>
    </t>

</templates>

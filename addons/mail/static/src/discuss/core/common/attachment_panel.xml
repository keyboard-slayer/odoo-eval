<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.AttachmentPanel">
        <t t-set="title">Attachments</t>
        <ActionPanel title="title" asAttachment="true">
            <div t-if="hasToggleAllowPublicUpload" class="form-check form-switch">
                <label class="form-check-label">
                    <input t-on-change="toggleAllowPublicUpload" class="form-check-input" type="checkbox" role="switch" t-att-checked="props.thread.allow_public_upload"/>
                    <t t-if="props.thread.allow_public_upload">File upload is enabled for external users</t>
                    <t t-else="">File upload is disabled for external users</t>
                </label>
            </div>
            <div class="d-flex flex-column flex-grow-1">
                <div class="o-mail-AttachmentpanelCategory d-flex flex-row justify-content-around" t-on-click="(ev) => this.state.current = ev.target.dataset.tab">
                    <t t-foreach="this.attachmentCategories" t-as="category" t-key="category[0]">
                        <span class="o-mail-AttachmentPanelCategory-title text-center w-100 cursor-pointer"
                            t-att-class="this.state.current === category[0] ? 'o-selected' : ''"
                            t-attf-class='o-mail-Attachment-{{ category[0] }}'
                            t-att-data-tab="category[0]">
                            <t t-out="category[1]"/>
                        </span>
                    </t>
                </div>
                <div t-attf-class="'o-mail-attachmentPanel-{{ this.state.current }}'">
                    <p t-if="Object.keys(attachmentsByDate).length === 0" class="text-center fst-italic text-500 mt-4">
                        <t t-if="props.thread.type === 'channel'">This channel doesn't have any <t t-out="this.state.current"/> attachments.</t>
                        <t t-else="">This conversation doesn't have any <t t-out="this.state.current"/> attachments.</t>
                    </p>
                    <div t-foreach="this.attachmentsByDate" t-as="attachments" t-key="attachments">
                        <DateSection date="attachments" className="'my-1'"/>
                        <LinkPreviewList t-if="this.state.current === 'link'" linkPreviews="attachments_value" deletable="false" asAttachment="true"/>
                        <AttachmentList t-else="" imagesHeight="100" maxWidth="100" attachments="attachments_value" unlinkAttachment="(attachment) => this.attachmentUploadService.unlink(attachment)"/>
                    </div>
                </div>
            </div>
            <span t-ref="load-older"/>
        </ActionPanel>
    </t>
</templates>

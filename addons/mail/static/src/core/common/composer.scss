.o-mail-Composer {
    grid-template-areas:
        "sidebar-header core-header"
        "sidebar-main core-main"
        "sidebar-footer core-footer";
    grid-template-columns: auto 1fr;
    grid-template-rows: auto 1fr auto;

    &.o-hasSelfAvatar {
        grid-template-columns: $o-mail-Message-sidebarWidth 1fr;
    }

    .o-mail-Composer-sidebarMain {
        // padding-top: 0.09375rem; // avatar centered with composer text input: 32px (avatar) + 2*1.5px (this value) = 25px ($input-height) + 7px (padding-top) + 2px (border)
        width: 40px;
    }

    .o-mail-Composer-coreHeader {
        grid-area: core-header;
    }

    .o-mail-Composer-coreMain {
        grid-area: core-main;
    }

    .o-mail-Composer-sidebarMain {
        grid-area: sidebar-main;
    }

    .o-mail-Composer-footer {
        grid-area: core-footer;
    }
}

.o-mail-Composer-actions {

    &.o-left {
        margin-top: 1px;
        margin-left: 1px;
    }

    &.o-right {
        margin-top: 1px;
        margin-right: 1px;
    }

    &.o-mobile {
        margin-top: 2px;
        margin-right: 0px;
    }

    &:not(.o-focused) button {
        color: $text-muted;
    }

    button {
        &:hover {
            background-color: $gray-200;
            border-color: $gray-500 !important;
            i {
                filter: contrast(2);
            }
            &.o-mail-Composer-send:not(.o-extended) {
                background-color: $o-action !important;
                border-color: darken($o-action, 5%) !important;
            }
        }
    }
}

.o-mail-Composer-mainActions {
    gap: 1px;
}

.o-mail-Composer-moreActions button {
    background-color: $gray-200;
}

.o-mail-Composer-coreMainInner {
    --border-opacity: 0.75;

    &.o-fuse {
        background-color: $o-gray-100 !important;
    }

    &.o-fuse.o-focused {
        background-color: $o-view-background-color !important;
    }

    &.o-focused {
        border-color: rgba($o-action, 0.25) !important;
    }
}

.o-mail-Composer-input {
    padding-top: 7px; // carefully crafted to have the text in the middle
    padding-bottom: 6px;

    &.o-normal {
        padding-left: (map-get($spacers, 3) + map-get($spacers, 2)) / 2 !important;
        padding-right: (map-get($spacers, 3) + map-get($spacers, 2)) / 2 !important;
    }

    &.o-focused {
        border-color: rgba($o-action, 0.5) !important;
        background-color: $o-view-background-color;
    }

    max-height: 100px;
    resize: none;
    line-height: 1.42857143 !important; // so that input is rounded to 20px = 14px (base font) * 1.42857143 (line-height)

    .o-extended & {
        max-height: Min(400px, 30vh);
    }

    &::placeholder {
        opacity: 75%;
        @include text-truncate();
        user-select: none;
    }
}

.o-mail-Composer-avatar {
    --Avatar-size: 34px;
}

.o-mail-Composer-fake {
    height: 0;
    top: -10000px;

    padding-top: 7px;
    padding-bottom: 6px;

    &.o-normal {
        padding-left: (map-get($spacers, 3) + map-get($spacers, 2)) / 2 !important;
        padding-right: (map-get($spacers, 3) + map-get($spacers, 2)) / 2 !important;
    }

    line-height: 1.42857143 !important; // so that input is rounded to 20px = 14px (base font) * 1.42857143 (line-height)
}

.o-mail-Composer-input {
    font-family: "text-emoji", $font-family-base;
}

.o-mail-Composer-send:not(.o-extended):not(.o-disabled) {
    background-color: lighten($o-action, 5%);
    color: white;    
}
